<div class="d-flex justify-content-end mb-2">
    <button type="button" class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#confirmationModal"
        data-action-url="{{ url_for('clear_all') }}"
        data-message="Are you sure you want to delete ALL scheduled items and media files? This action cannot be undone."
        {% if not items %}disabled{% endif %}>
        Clear All</button>
</div>

<div class="list-group">
    {% for it in items %}
    <div class="mb-2">
        <div class="list-group-item d-flex align-items-center {% if it.post_type == 'story' %}story-border{% else %}post-border{% endif %}"
            style="border-radius: 8px;">
            <div class="me-3">
                {% if it.media_type == 'image' %}
                <img src="{{ url_for('static', filename='uploads/' + it.filename|basename) }}" class="media-preview">
                {% elif it.media_type == 'video' %}
                <video src="{{ url_for('static', filename='uploads/' + it.filename|basename) }}" class="media-preview"
                    preload="metadata"></video>
                {% endif %}
            </div>

            <div class="flex-grow-1 me-3">
                <div class="d-flex w-100 justify-content-between">
                    <h6 class="mb-1" style="word-break: break-all;">{{ it.filename|basename }}</h6>
                    <small class="text-muted text-nowrap">{{ it.scheduled_time | to_local_time }}</small>
                </div>
                <p class="mb-1">
                    <span class="badge rounded-pill text-bg-{{ 'dark' if it.post_type == 'post' else 'warning' }}">{{
                        it.post_type|capitalize }}</span>
                    <span
                        class="badge rounded-pill text-bg-{{ 'success' if it.status.value == 'uploaded' else ('secondary' if it.status.value == 'scheduled' else ('primary' if it.status.value == 'processing' else 'danger')) }}">{{
                        it.status.value }}</span>
                </p>
                {% if it.caption %}
                <p class="mb-1 fst-italic text-muted">
                    {{ it.caption }}
                </p>
                {% endif %}
            </div>

            <div>
                <button type="button" class="btn btn-link text-danger p-0" aria-label="Delete" data-bs-toggle="modal"
                    data-bs-target="#confirmationModal" data-action-url="{{ url_for('delete_item', item_id=it.id) }}"
                    data-message="Are you sure you want to delete the item '{{ it.filename|basename }}'? This will remove it from the history and delete the local file.">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                        class="bi bi-x-circle" viewBox="0 0 16 16">
                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                        <path
                            d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z" />
                    </svg>
                </button>
            </div>
        </div>
    </div>
    {% else %}
    <div class="text-center text-muted p-4 border rounded" style="border-radius: 8px;">Your queue is empty.</div>
    {% endfor %}
</div>